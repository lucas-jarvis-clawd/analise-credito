<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultado da Importação</title>
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.2/css/bootstrap.min.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/theme.css}">
</head>
<body>
    <!-- Top Bar -->
    <div th:replace="~{fragments/layout :: topbar}"></div>

    <!-- Sidebar -->
    <div th:replace="~{fragments/layout :: sidebar('importacao')}"></div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Page Header -->
        <div class="page-header animate-in">
            <div>
                <h2><i class="bi bi-check2-square"></i> Resultado da Importação</h2>
                <div class="page-subtitle">Resumo do processamento dos arquivos</div>
            </div>
        </div>

        <!-- Status -->
        <div th:classappend="${resultado.status == 'SUCESSO'} ? 'alert-theme-success' :
                           (${resultado.status == 'SUCESSO_PARCIAL'} ? 'alert-theme-warning' : 'alert-theme-danger')"
             class="mb-theme animate-in" role="alert">
            <h4 style="margin:0 0 0.5rem;font-size:1rem;">
                <i th:if="${resultado.status == 'SUCESSO'}" class="bi bi-check-circle-fill"></i>
                <i th:if="${resultado.status == 'SUCESSO_PARCIAL'}" class="bi bi-exclamation-circle-fill"></i>
                <i th:if="${resultado.status == 'ERRO'}" class="bi bi-x-circle-fill"></i>
                <span th:text="${resultado.status}"></span>
            </h4>
            <p th:if="${resultado.status == 'SUCESSO'}" style="margin:0;font-size:0.875rem;">
                A importação foi concluída com sucesso! Todos os registros foram processados.
            </p>
            <p th:if="${resultado.status == 'SUCESSO_PARCIAL'}" style="margin:0;font-size:0.875rem;">
                A importação foi concluída com avisos. Alguns registros podem ter sido ignorados.
            </p>
            <p th:if="${resultado.status == 'ERRO'}" style="margin:0;font-size:0.875rem;">
                A importação falhou. Verifique os erros abaixo e tente novamente.
            </p>
        </div>

        <!-- Statistics -->
        <div class="card-theme mb-theme animate-in">
            <div class="card-header-theme">
                <i class="bi bi-bar-chart-fill"></i> Estatísticas de Importação
            </div>
            <div class="card-body">
                <div class="row" style="gap-y:1rem;">
                    <div class="col-md-3 mb-3">
                        <div class="import-stat">
                            <i class="bi bi-people-fill"></i>
                            <h3 th:text="${resultado.clientesImportados}">0</h3>
                            <small>Clientes</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="import-stat">
                            <i class="bi bi-cart-fill"></i>
                            <h3 th:text="${resultado.pedidosImportados}">0</h3>
                            <small>Pedidos</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="import-stat">
                            <i class="bi bi-graph-up"></i>
                            <h3 th:text="${resultado.dadosBIImportados}">0</h3>
                            <small>Dados BI</small>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="import-stat">
                            <i class="bi bi-receipt"></i>
                            <h3 th:text="${resultado.duplicatasImportadas}">0</h3>
                            <small>Duplicatas</small>
                        </div>
                    </div>
                </div>
                <hr style="border-color:var(--border-light);">
                <div class="text-center">
                    <span style="font-size:1rem;font-weight:600;color:var(--text-heading);">
                        <i class="bi bi-database-fill" style="color:var(--gold);"></i>
                        Total de Registros:
                        <span class="badge-gold" style="font-size:0.85rem;padding:0.35rem 0.75rem;" th:text="${resultado.totalImportado}">0</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- Errors -->
        <div th:if="${resultado.erros != null and !resultado.erros.empty}" class="config-card mb-theme animate-in">
            <div class="config-card-header" style="background:var(--danger-bg);color:#8b1a13;">
                <i class="bi bi-exclamation-octagon-fill"></i>
                Erros (<span th:text="${#lists.size(resultado.erros)}">0</span>)
            </div>
            <div class="config-card-body">
                <ul style="margin:0;padding-left:1.25rem;font-size:0.85rem;">
                    <li th:each="erro : ${resultado.erros}" th:text="${erro}"></li>
                </ul>
            </div>
        </div>

        <!-- Warnings -->
        <div th:if="${resultado.avisos != null and !resultado.avisos.empty}" class="config-card mb-theme animate-in">
            <div class="config-card-header warning">
                <i class="bi bi-exclamation-triangle-fill"></i>
                Avisos (<span th:text="${#lists.size(resultado.avisos)}">0</span>)
            </div>
            <div class="config-card-body">
                <ul style="margin:0;padding-left:1.25rem;font-size:0.85rem;">
                    <li th:each="aviso : ${resultado.avisos}" th:text="${aviso}"></li>
                </ul>
            </div>
        </div>

        <!-- No errors or warnings -->
        <div th:if="${(resultado.erros == null or resultado.erros.empty) and (resultado.avisos == null or resultado.avisos.empty)}"
             class="alert-theme-success mb-theme animate-in">
            <i class="bi bi-check-circle-fill"></i>
            Nenhum erro ou aviso reportado. Importação completamente limpa!
        </div>

        <div style="display:flex;justify-content:flex-end;gap:0.75rem;margin-bottom:3rem;" class="animate-in">
            <a th:href="@{/importacao}" class="btn-ghost" style="padding:0.65rem 1.5rem;font-size:0.95rem;">
                <i class="bi bi-arrow-clockwise"></i> Nova Importação
            </a>
            <a href="/" class="btn-gold" style="padding:0.65rem 1.5rem;font-size:0.95rem;text-decoration:none;">
                <i class="bi bi-house-fill"></i> Ir para Home
            </a>
        </div>
    </div>

    <script th:src="@{/webjars/bootstrap/5.3.2/js/bootstrap.bundle.min.js}"></script>
</body>
</html>
